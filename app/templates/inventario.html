{% extends "base.html" %}
{% block content %}
<h2>Inventario</h2>
{% if mensaje %}
  <div style="background-color: #fdd; color: #900; padding: 10px; border-radius: 5px; margin-bottom: 10px;">
    {{ mensaje }}
  </div>
{% endif %}

<ul>
  {% for p in productos %}
    <li>
      <strong>ID: {{ p.id }}</strong><br>

      <!-- Imagen del producto -->
      {% if p.id %}
        <img src="/static/images/{{ p.id }}.jpg" alt="{{ p.nombre }}" width="150" height="150"
             onerror="this.onerror=null;this.src='/static/images/default-product.png';">
      {% else %}
        <img src="/static/images/default-product.png" alt="Sin imagen" width="150" height="150">
      {% endif %}

      <!-- Formulario de actualización inline -->
      <form action="/productos/actualizar/{{ p.id }}" method="post" style="margin-top: 10px;">
        <input type="text" name="nombre" value="{{ p.nombre }}" required>
        <input type="number" name="precio" value="{{ p.precio }}" step="0.01" required>
        <input type="number" name="stock" value="{{ p.cantidad }}" required>
        <button type="submit">Actualizar</button>
      </form>

      <!-- Formulario para eliminar -->
      <form action="/productos/eliminar/{{ p.id }}" method="post" style="margin-top: 5px;" onsubmit="return confirm('¿Eliminar producto {{ p.nombre }}?');">
        <button type="submit">Eliminar</button>
      </form>
    </li>
    <hr>
  {% endfor %}
</ul>

<h3>Agregar Nuevo Producto</h3>
<form action="/productos/agregar" method="post">
  <input name="nombre" placeholder="Nombre" required>
  <input name="precio" placeholder="Precio" type="number" step="0.01" required>
  <input name="cantidad" placeholder="Stock" type="number" required>
  <button type="submit">Agregar Producto</button>
</form>
<!-- Botón para volver al Home -->
<br>
<a href="/home" style="text-decoration: none;">
  <button type="button">← Volver al home</button>
</a>
{% endblock %}
